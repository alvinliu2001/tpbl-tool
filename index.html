<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TPBL ç¤¾ç¾¤æ–‡æ¡ˆç”Ÿæˆå·¥å…·</title>
    <meta name="description" content="TPBL è·ç±ƒè¯ç›Ÿç¤¾ç¾¤æ–‡æ¡ˆè‡ªå‹•ç”Ÿæˆèˆ‡ç®¡ç†å·¥å…·">
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ€</text></svg>">
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        /* Active Sidebar Item: Gold background, Dark text */
        .sidebar-item.active { background-color: #D8BF98; color: #19191A; font-weight: 700; }
        
        /* FIX: Ensure text turns white on hover for better contrast against dark background */
        .sidebar-item:hover { color: #ffffff !important; }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Custom Utility Classes for Brand Colors */
        .text-brand-gold { color: #D8BF98; }
        .bg-brand-dark { background-color: #19191A; }
        .bg-brand-gold { background-color: #D8BF98; }
        .border-brand-gold { border-color: #D8BF98; }
        .focus-ring-gold:focus { --tw-ring-color: #D8BF98; }

        /* Custom Select Arrow */
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem !important; /* Make space for the arrow */
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            dark: '#19191A',
                            gold: '#D8BF98',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 text-gray-800 md:h-screen flex flex-col md:flex-row md:overflow-hidden min-h-screen">

    <!-- Sidebar Navigation -->
    <!-- Modified for RWD: w-full on mobile, sticky top, with toggle -->
    <aside class="w-full md:w-64 bg-brand-dark text-gray-400 flex flex-col flex-shrink-0 md:h-full z-30 sticky top-0 md:relative shadow-lg md:shadow-none">
        <div class="p-4 md:p-6 border-b border-gray-800 flex justify-between items-center bg-brand-dark">
            <div>
                <h1 class="text-xl md:text-2xl font-bold text-white tracking-wider">TPBL<span class="text-brand-gold">.TOOL</span></h1>
                <p class="text-xs text-gray-500 mt-1">ç¤¾ç¾¤æ–‡æ¡ˆç”Ÿæˆå·¥å…·</p>
            </div>
            <!-- Mobile Menu Button -->
            <button onclick="toggleSidebar()" class="md:hidden text-white p-2 focus:outline-none border border-gray-700 rounded hover:bg-gray-800">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </div>
        
        <!-- Nav Container (Hidden on mobile by default) -->
        <nav id="sidebar-nav" class="hidden md:flex flex-col flex-1 overflow-y-auto py-4 space-y-1 bg-brand-dark absolute md:static w-full top-full left-0 shadow-xl md:shadow-none max-h-[80vh] md:max-h-full">
            
            <div class="px-4 py-2 text-xs font-bold text-gray-600 uppercase tracking-wider">è³½å‰é ç†±</div>
            <button onclick="switchMode('weekday_preview')" id="btn-weekday_preview" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ—“ï¸</span> å¹³æ—¥è³½äº‹é å‘Š
            </button>
            <button onclick="switchMode('game_preview')" id="btn-game_preview" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ”¥</span> å–®å ´è³½ç¨‹é å‘Š
            </button>
            <button onclick="switchMode('weekly_schedule')" id="btn-weekly_schedule" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ“…</span> æ¯é€±è³½ç¨‹è¡¨
            </button>

            <div class="px-4 py-2 mt-4 text-xs font-bold text-gray-600 uppercase tracking-wider">è³½äº‹é€²è¡Œ / è³½å¾Œ</div>
            <button onclick="switchMode('final_score')" id="btn-final_score" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ</span> çµ‚å ´æ¯”åˆ†
            </button>
            <button onclick="switchMode('game_highlight')" id="btn-game_highlight" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ¥</span> æœ¬å ´è³½äº‹ç²¾è¯
            </button>
            <button onclick="switchMode('press_conf')" id="btn-press_conf" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ—£ï¸</span> è³½å¾Œè¨˜è€…æœƒ
            </button>
            <button onclick="switchMode('potg')" id="btn-potg" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>âš¡</span> å–®å ´æœ€ä½³çƒå“¡
            </button>

            <div class="px-4 py-2 mt-4 text-xs font-bold text-gray-600 uppercase tracking-wider">æ¯é€±ç¸½çµ</div>
            <button onclick="switchMode('weekly_standings')" id="btn-weekly_standings" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ“Š</span> æ¯é€±æˆ°ç¸¾æ’è¡Œ
            </button>
            <button onclick="switchMode('top5')" id="btn-top5" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ’£</span> æœ¬é€±äº”å¤§å¥½çƒ
            </button>
            <button onclick="switchMode('potw')" id="btn-potw" class="sidebar-item w-full text-left px-6 py-3 hover:bg-gray-800 transition flex items-center gap-3">
                <span>ğŸ¥‡</span> å–®é€±æœ€ä½³çƒå“¡
            </button>
        </nav>
    </aside>

    <!-- Main Content -->
    <!-- Modified for RWD: Vertical stack on mobile, horizontal on desktop -->
    <main class="flex-1 flex flex-col md:flex-row md:h-full md:overflow-hidden relative">
        
        <!-- Input Area (Scrollable) -->
        <div class="flex-1 overflow-y-auto p-4 md:p-8 bg-white md:h-full" id="input-container">
            <div class="max-w-2xl mx-auto pb-10 md:pb-0">
                <h2 id="current-title" class="text-xl md:text-2xl font-bold mb-6 text-gray-800 border-l-4 border-brand-gold pl-4">è«‹é¸æ“‡åŠŸèƒ½</h2>
                
                <!-- Dynamic Form Container -->
                <div id="dynamic-form" class="space-y-5">
                    <!-- Forms will be injected here by JS -->
                    <p class="text-gray-500">è«‹å¾å·¦å´é¸å–®é¸æ“‡æ‚¨è¦ç”Ÿæˆçš„è²¼æ–‡é¡å‹ã€‚</p>
                </div>

                <div class="mt-8 pt-6 border-t border-gray-100">
                    <button onclick="generateCopy()" class="w-full bg-brand-dark hover:bg-brand-gold hover:text-brand-dark text-white font-bold py-4 px-6 rounded-lg transition duration-200 flex justify-center items-center gap-2 shadow-lg">
                        <span>ç”Ÿæˆæ–‡æ¡ˆ</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Output Area (Fixed on Desktop, Stacked on Mobile) -->
        <div class="w-full md:w-1/3 bg-gray-100 p-6 flex flex-col border-t md:border-t-0 md:border-l border-gray-200">
            <h3 class="text-lg font-bold mb-4 text-gray-700 flex items-center gap-2">
                é è¦½çµæœ
            </h3>
            <textarea id="output-text" class="flex-1 w-full p-4 border border-gray-300 rounded-lg font-mono text-sm resize-none focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-brand-gold bg-white leading-relaxed h-64 md:h-auto" placeholder="æ–‡æ¡ˆå°‡é¡¯ç¤ºæ–¼æ­¤..."></textarea>
            
            <button onclick="copyToClipboard()" class="mt-4 w-full bg-white border-2 border-gray-200 hover:border-brand-dark text-gray-800 font-bold py-3 px-4 rounded-lg transition duration-200 flex justify-center items-center gap-2">
                <span id="copy-text">ä¸€éµè¤‡è£½</span>
            </button>
        </div>

    </main>

    <!-- JavaScript Logic -->
    <script>
        // --- Mobile Sidebar Toggle ---
        function toggleSidebar() {
            const nav = document.getElementById('sidebar-nav');
            if (nav.classList.contains('hidden')) {
                nav.classList.remove('hidden');
                nav.classList.add('flex');
            } else {
                nav.classList.add('hidden');
                nav.classList.remove('flex');
            }
        }

        // --- Data & Config ---
        const TEAMS = {
            "æˆ°ç¥": { full: "è‡ºåŒ—å°æ–°æˆ°ç¥", emoji: "ğŸ›¡ï¸", arena: "å’Œå¹³ç±ƒçƒé¤¨" },
            "æ”»åŸç…": { full: "æ–°ç«¹å¾¡åµ¿æ”»åŸç…", emoji: "ğŸ¦", arena: "æ–°ç«¹ç¸£ç«‹é«”è‚²é¤¨" },
            "ç‰¹æ”»": { full: "æ–°åŒ—ä¸­ä¿¡ç‰¹æ”»", emoji: "âš¡ï¸", arena: "æ–°èŠé«”è‚²é¤¨" },
            "åœ‹ç‹": { full: "æ–°åŒ—åœ‹ç‹", emoji: "ğŸ‘‘", arena: "æ–°èŠé«”è‚²é¤¨" },
            "å¤¢æƒ³å®¶": { full: "ç¦çˆ¾æ‘©æ²™å¤¢æƒ³å®¶", emoji: "ğŸ¦„", arena: "æ´²éš›è¿·ä½ è›‹" },
            "æµ·ç¥": { full: "é«˜é›„å…¨å®¶æµ·ç¥", emoji: "ğŸ”±", arena: "é«˜é›„å·¨è›‹" },
            "é›²è±¹": { full: "å°å•¤æ°¸è±é›²è±¹", emoji: "ğŸ†", arena: "æ¡ƒåœ’å·¨è›‹" }
        };
        const TEAM_KEYS = Object.keys(TEAMS);
        const GAME_TIMES = ["14:30", "17:00", "19:00"];
        
        // Data type mapping for POTW
        const STAT_TYPES = [
            { label: "å¾—åˆ†", val: "pts" },
            { label: "ç±ƒæ¿", val: "reb" },
            { label: "åŠ©æ”»", val: "ast" },
            { label: "æŠ„æˆª", val: "stl" },
            { label: "é˜»æ”»", val: "blk" },
            { label: "æ•ˆç‡å€¼", val: "eff" },
            { label: "ä¸‰åˆ†å‘½ä¸­", val: "3pm" },
            { label: "æŠ•ç±ƒå‘½ä¸­", val: "fgm" },
            { label: "ç½°çƒå‘½ä¸­", val: "ftm" },
            { label: "è‡ªè¨‚", val: "custom" }
        ];

        const COMMON_TAGS = "#TPBL #NothingButLove #ç±ƒçƒæ€èƒ½ä¸æ„›";
        const BROADCAST_INFO = "ğŸ‘‰ğŸ»è½‰æ’­å¹³å° ğŸ“º ç·¯ä¾†é›»è¦–ç¶²ï½œåšæ–¯é‹å‹•äºŒå°ï½œTPBLå®˜æ–¹YOUTUBE";

        let currentMode = '';

        // --- Font Converter ---
        const toMathBoldSerif = (text) => {
            const map = {
                '0': 'ğŸ', '1': 'ğŸ', '2': 'ğŸ', '3': 'ğŸ‘', '4': 'ğŸ’', '5': 'ğŸ“', '6': 'ğŸ”', '7': 'ğŸ•', '8': 'ğŸ–', '9': 'ğŸ—',
                'A': 'ğ€', 'B': 'ğ', 'C': 'ğ‚', 'D': 'ğƒ', 'E': 'ğ„', 'F': 'ğ…', 'G': 'ğ†', 'H': 'ğ‡', 'I': 'ğˆ', 'J': 'ğ‰',
                'K': 'ğŠ', 'L': 'ğ‹', 'M': 'ğŒ', 'N': 'ğ', 'O': 'ğ', 'P': 'ğ', 'Q': 'ğ', 'R': 'ğ‘', 'S': 'ğ’', 'T': 'ğ“',
                'U': 'ğ”', 'V': 'ğ•', 'W': 'ğ–', 'X': 'ğ—', 'Y': 'ğ˜', 'Z': 'ğ™',
                'a': 'ğš', 'b': 'ğ›', 'c': 'ğœ', 'd': 'ğ', 'e': 'ğ', 'f': 'ğŸ', 'g': 'ğ ', 'h': 'ğ¡', 'i': 'ğ¢', 'j': 'ğ£',
                'k': 'ğ¤', 'l': 'ğ¥', 'm': 'ğ¦', 'n': 'ğ§', 'o': 'ğ¨', 'p': 'ğ©', 'q': 'ğª', 'r': 'ğ«', 's': 'ğ¬', 't': 'ğ­',
                'u': 'ğ®', 'v': 'ğ¯', 'w': 'ğ°', 'x': 'ğ±', 'y': 'ğ²', 'z': 'ğ³'
            };
            return String(text).split('').map(char => map[char] || char).join('');
        };

        // --- Date Helpers (Safe Parsing) ---
        const parseDateLocal = (dateStr) => {
            if (!dateStr) return new Date();
            const parts = dateStr.split('-');
            return new Date(parts[0], parts[1] - 1, parts[2]);
        };

        const getDayName = (dateStr) => {
            const date = parseDateLocal(dateStr);
            const days = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
            return days[date.getDay()]; // 0-6
        };
        
        const getDayChi = (dateStr) => {
            const date = parseDateLocal(dateStr);
            const days = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
            return days[date.getDay()];
        };

        const formatMonthDay = (dateStr) => {
            const date = parseDateLocal(dateStr);
            const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
            return `${months[date.getMonth()]}.${String(date.getDate()).padStart(2, '0')}`;
        };

        const formatMMDD = (dateStr) => {
             const date = parseDateLocal(dateStr);
             return `${String(date.getMonth()+1).padStart(2,'0')}.${String(date.getDate()).padStart(2,'0')}`;
        };

        // --- UI Component Builders ---
        const createInput = (id, label, type="text", placeholder="", value="") => `
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">${label}</label>
                <input type="${type}" id="${id}" class="w-full p-2.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand-gold focus:border-brand-gold" placeholder="${placeholder}" value="${value}">
            </div>
        `;

        const createSelect = (id, label, options) => `
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">${label}</label>
                <select id="${id}" class="w-full p-2.5 border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-brand-gold focus:border-brand-gold">
                    ${options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                </select>
            </div>
        `;
        
        const createTeamSelect = (id, label) => createSelect(id, label, TEAM_KEYS);

        const createTimeSelect = (id, label, defaultValue="19:00") => `
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">${label}</label>
                <select id="${id}" class="w-full p-2.5 border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-brand-gold focus:border-brand-gold">
                    ${GAME_TIMES.map(t => `<option value="${t}" ${t === defaultValue ? 'selected' : ''}>${t}</option>`).join('')}
                </select>
            </div>
        `;

        const createTextarea = (id, label, placeholder="", rows=4, value="") => `
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">${label}</label>
                <textarea id="${id}" rows="${rows}" class="w-full p-2.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-brand-gold focus:border-brand-gold" placeholder="${placeholder}">${value}</textarea>
            </div>
        `;

        // --- Switch Mode Logic ---
        function switchMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`btn-${mode}`).classList.add('active');
            
            // Auto-close sidebar on mobile after selection
            if (window.innerWidth < 768) {
                document.getElementById('sidebar-nav').classList.add('hidden');
                document.getElementById('sidebar-nav').classList.remove('flex');
            }

            const titles = {
                'weekday_preview': 'å¹³æ—¥è³½äº‹é å‘Š',
                'game_preview': 'å–®å ´è³½ç¨‹é å‘Š',
                'weekly_schedule': 'æ¯é€±è³½ç¨‹è¡¨',
                'final_score': 'çµ‚å ´æ¯”åˆ†',
                'game_highlight': 'æœ¬å ´è³½äº‹ç²¾è¯',
                'press_conf': 'è³½å¾Œè¨˜è€…æœƒç²¾è¯',
                'potg': 'å–®å ´æœ€ä½³çƒå“¡',
                'weekly_standings': 'æ¯é€±æˆ°ç¸¾æ’è¡Œ',
                'top5': 'æœ¬é€±äº”å¤§å¥½çƒ',
                'potw': 'å–®é€±æœ€ä½³çƒå“¡'
            };
            document.getElementById('current-title').innerText = titles[mode];
            renderForm(mode);
        }

        function renderForm(mode) {
            const container = document.getElementById('dynamic-form');
            let html = '';

            // Common next game block for many templates
            const nextGameBlock = `
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mt-4">
                    <p class="text-xs font-bold text-gray-500 mb-2 uppercase">ä¸‹å ´è³½äº‹è³‡è¨Š (Next Game)</p>
                    <div class="grid grid-cols-2 gap-4">
                        ${createInput('next_date', 'æ—¥æœŸ', 'date')}
                        ${createInput('next_game_num', 'å ´æ¬¡ (Game)', 'number')}
                        ${createTimeSelect('next_time', 'æ™‚é–“ (HH:mm)', '19:00')}
                        <div></div>
                        ${createTeamSelect('next_away', 'å®¢éšŠ (Away)')}
                        ${createTeamSelect('next_home', 'ä¸»éšŠ (Home)')}
                    </div>
                </div>
            `;

            if (mode === 'game_preview') {
                html += `
                    <div class="grid grid-cols-2 gap-4">
                        ${createInput('game_num', 'å ´æ¬¡ (GAME)', 'number', '32', '32')}
                        ${createInput('match_date', 'æ¯”è³½æ—¥æœŸ', 'date')}
                        ${createTimeSelect('match_time', 'æ¯”è³½æ™‚é–“', '19:00')}
                        <div></div>
                        ${createTeamSelect('away_team', 'å®¢éšŠ (Away)')}
                        ${createTeamSelect('home_team', 'ä¸»éšŠ (Home)')}
                    </div>
                    ${createTextarea('highlight_text', 'è§€è³½äº®é»', 'è¼¸å…¥æœ¬å ´çœ‹é»æ–‡æ¡ˆ...', 6)}
                    ${createInput('yt_link', 'YouTube è½‰æ’­é€£çµ', 'text')}
                `;
            } else if (mode === 'weekday_preview') {
                html += `
                     <div class="grid grid-cols-2 gap-4">
                        ${createInput('match_date', 'æ¯”è³½æ—¥æœŸ', 'date')}
                        ${createTimeSelect('match_time', 'æ¯”è³½æ™‚é–“', '19:00')}
                        ${createTeamSelect('away_team', 'å®¢éšŠ (Away)')}
                        ${createTeamSelect('home_team', 'ä¸»éšŠ (Home)')}
                    </div>
                    ${createInput('promo_title', 'é å‘Šæ¨™é¡Œ (å¦‚ï¼šWEDNESDAY NIGHT...)', 'text', 'WEDNESDAY NIGHT, LETâ€™S GOOOO')}
                    ${createTextarea('promo_text', 'é å‘Šæ–‡æ¡ˆ', 'æœ¬å­£é¦–æ¬¡äº¤æ‰‹çš„...', 4)}
                    ${createTextarea('promo_link', 'è´ŠåŠ©å•†ç‰ˆä½ (å¯æ›è¡Œ)', 'ğŸ“SPORTS NATIONSåº—é»è³‡è¨Š...', 3)}
                `;
            } else if (mode === 'final_score') {
                html += `
                    ${createInput('game_num', 'å ´æ¬¡ (GAME)', 'number', '31')}
                    ${createInput('match_title', 'æ¨™é¡Œ (ä¾‹å¦‚ï¼šå…¨éšŠã€Œè±¹ã€é€²13è¨˜å¤–ç·š...)', 'text')}
                    ${createTextarea('match_recap', 'æ¯”è³½å›é¡§æ–‡æ¡ˆ', '', 6)}
                    ${nextGameBlock}
                `;
            } else if (mode === 'game_highlight') {
                html += `
                    ${createInput('hl_title', 'ç²¾è¯æ¨™é¡Œ (å«Emoji)', 'text', 'â¤ï¸ğŸ‘‰ ï½œäºå–µé¦–ç¯€2è¨˜å¤–ç·š...')}
                    ${createInput('yt_link', 'YouTube é€£çµ', 'text')}
                `;
            } else if (mode === 'press_conf') {
                html += `
                    ${createInput('pc_title', 'æ¨™é¡Œ (è‹±æ–‡/ä¸­æ–‡)', 'text', 'ğŸ—£ï¸ FACING THE STORM...')}
                    ${createTextarea('pc_quote', 'èªéŒ„ (ä¸éœ€è¦æ‰“å¼•è™Ÿ)', '', 3)}
                    ${createTextarea('pc_content', 'å…§å®¹', '', 6)}
                    ${nextGameBlock}
                `;
            } else if (mode === 'potg') {
                html += `
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        ${createTeamSelect('potg_away', 'å®¢éšŠ (Away)')}
                        ${createTeamSelect('potg_home', 'ä¸»éšŠ (Home)')}
                    </div>
                    ${nextGameBlock}
                    ${createInput('promo_text', 'åº•éƒ¨æ´»å‹•æ–‡æ¡ˆ', 'text', 'ğŸ€„æ‹šç«¶æŠ€ï¼Œè¶…å¸¶å‹...')}
                `;
            } else if (mode === 'weekly_schedule') {
                html += `
                    ${createInput('week_num', 'ç¬¬å¹¾é€± (Week)', 'number', '8')}
                    ${createTextarea('week_intro', 'æœ¬é€±è³½ç¨‹å¼•è¨€', '', 4)}
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-sm font-bold mb-2">æœ¬é€±è³½ç¨‹åˆ—è¡¨</p>
                        <div id="schedule_list_container" class="space-y-3"></div>
                        <button onclick="addScheduleItem()" class="mt-2 text-sm font-bold text-brand-gold hover:text-yellow-600">+ æ–°å¢å ´æ¬¡</button>
                    </div>
                `;
                setTimeout(() => { addScheduleItem(); addScheduleItem(); }, 100);
            } else if (mode === 'weekly_standings') {
                html += `
                    ${createInput('week_num', 'ç¬¬å¹¾é€± (Week)', 'number', '7')}
                    ${createTextarea('standings_content', 'æˆ°ç¸¾åˆ†ææ–‡æ¡ˆ', '', 8)}
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mt-4">
                        <p class="text-sm font-bold mb-2">æœ¬é€±è³½ç¨‹åˆ—è¡¨</p>
                        <div id="standings_schedule_list_container" class="space-y-3"></div>
                        <button onclick="addStandingsGameItem()" class="mt-2 text-sm font-bold text-brand-gold hover:text-yellow-600">+ æ–°å¢é å‘Šå ´æ¬¡</button>
                    </div>
                `;
                 setTimeout(() => { addStandingsGameItem(); }, 100);
            } else if (mode === 'top5') {
                 html += `
                    ${createInput('week_num', 'ç¬¬å¹¾é€± (Week)', 'number', '7')}
                    ${createTextarea('top5_intro', 'å¼•è¨€æ–‡æ¡ˆ', '', 3)}
                    <div class="space-y-3 mt-4">
                        <p class="text-sm font-bold text-gray-500">äº”å¤§å¥½çƒæ’è¡Œ</p>
                        ${[1,2,3,4,5].map(i => `
                            <div class="p-3 border rounded-md bg-gray-50">
                                <span class="font-bold text-gray-700 block mb-1">ç¬¬ ${i} å</span>
                                <div class="grid grid-cols-3 gap-2">
                                    <select id="top${i}_team" class="p-2 border rounded text-sm bg-white col-span-1 focus:ring-brand-gold focus:border-brand-gold">
                                        ${TEAM_KEYS.map(k=>`<option value="${k}">${k}</option>`).join('')}
                                    </select>
                                    <input id="top${i}_num" type="text" placeholder="èƒŒè™Ÿ (21)" class="p-2 border rounded text-sm col-span-1 focus:ring-brand-gold focus:border-brand-gold">
                                    <input id="top${i}_name" type="text" placeholder="çƒå“¡å" class="p-2 border rounded text-sm col-span-1 focus:ring-brand-gold focus:border-brand-gold">
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    ${createInput('vote_link', 'æŠ•ç¥¨é€£çµ', 'text')}
                `;
            } else if (mode === 'potw') {
                html += `
                    ${createInput('player_name', 'çƒå“¡åç¨± (ä¸­æ–‡+è‹±æ–‡)', 'text', 'å¸ƒé‡ŒèŒ²å…‹ Bogdan Bliznyuk')}
                    ${createTeamSelect('player_team', 'æ‰€å±¬éšŠä¼')}
                    
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mt-2">
                        <p class="text-sm font-bold mb-2">æœ¬é€±æ•¸æ“š (STATS)</p>
                        <div id="stats_list_container" class="space-y-2"></div>
                        <button onclick="addStatItem()" class="mt-2 text-sm font-bold text-brand-gold hover:text-yellow-600">+ æ–°å¢æ•¸æ“š</button>
                    </div>
                    
                    ${createTextarea('player_desc', 'çƒå“¡è¡¨ç¾æè¿°', '', 6)}
                    ${nextGameBlock}
                `;
                setTimeout(() => { addStatItem(); addStatItem(); addStatItem(); }, 100);
            }

            container.innerHTML = html;
        }

        // --- Helper for Weekly Schedule ---
        function addScheduleItem() {
            const container = document.getElementById('schedule_list_container');
            const idx = container.children.length;
            const div = document.createElement('div');
            // Changed from grid to flex to prevent wrapping
            div.className = "flex gap-2 text-sm items-center";
            
            const timeOptions = GAME_TIMES.map(t => `<option value="${t}">${t}</option>`).join('');
            
            div.innerHTML = `
                <input type="date" id="sch_date_${idx}" class="w-32 p-1 border rounded focus:ring-brand-gold focus:border-brand-gold">
                <select id="sch_time_${idx}" class="w-24 p-1 border rounded bg-white focus:ring-brand-gold focus:border-brand-gold">${timeOptions}</select>
                <select id="sch_away_${idx}" class="flex-1 p-1 border rounded bg-white focus:ring-brand-gold focus:border-brand-gold">${TEAM_KEYS.map(k=>`<option value="${k}">${k}</option>`).join('')}</select>
                <span class="text-center shrink-0">vs</span>
                <select id="sch_home_${idx}" class="flex-1 p-1 border rounded bg-white focus:ring-brand-gold focus:border-brand-gold">${TEAM_KEYS.map(k=>`<option value="${k}">${k}</option>`).join('')}</select>
                <button onclick="this.parentElement.remove()" class="text-red-500 font-bold px-2 shrink-0">&times;</button>
            `;
            container.appendChild(div);
        }

        // --- Helper for Standings Schedule ---
        function addStandingsGameItem() {
            const container = document.getElementById('standings_schedule_list_container');
            const idx = container.children.length;
            const div = document.createElement('div');
            // Changed from grid to flex to prevent wrapping
            div.className = "flex gap-2 text-sm items-center";
            
            const timeOptions = GAME_TIMES.map(t => `<option value="${t}">${t}</option>`).join('');
            
            // Format similar to weekly schedule inputs
            div.innerHTML = `
                <input type="date" id="std_sch_date_${idx}" class="w-32 p-1 border rounded focus:ring-brand-gold focus:border-brand-gold">
                <select id="std_sch_time_${idx}" class="w-24 p-1 border rounded bg-white focus:ring-brand-gold focus:border-brand-gold">${timeOptions}</select>
                <select id="std_sch_away_${idx}" class="flex-1 p-1 border rounded bg-white focus:ring-brand-gold focus:border-brand-gold">${TEAM_KEYS.map(k=>`<option value="${k}">${k}</option>`).join('')}</select>
                <span class="text-center shrink-0">vs</span>
                <select id="std_sch_home_${idx}" class="flex-1 p-1 border rounded bg-white focus:ring-brand-gold focus:border-brand-gold">${TEAM_KEYS.map(k=>`<option value="${k}">${k}</option>`).join('')}</select>
                <button onclick="this.parentElement.remove()" class="text-red-500 font-bold px-2 shrink-0">&times;</button>
            `;
            container.appendChild(div);
        }

        // --- Helper for POTW Stats ---
        function addStatItem() {
            const container = document.getElementById('stats_list_container');
            const idx = container.children.length;
            const div = document.createElement('div');
            div.className = "flex gap-2 items-center";
            
            const typeOptions = STAT_TYPES.map(t => `<option value="${t.val}">${t.label}</option>`).join('');
            
            div.innerHTML = `
                <input type="text" id="stat_val_${idx}" placeholder="æ•¸å€¼ (28)" class="w-20 p-2 border rounded text-sm focus:ring-brand-gold focus:border-brand-gold">
                <select id="stat_type_${idx}" onchange="toggleCustomStat(${idx})" class="w-32 p-2 border rounded text-sm bg-white focus:ring-brand-gold focus:border-brand-gold">
                    ${typeOptions}
                </select>
                <input type="text" id="stat_cust_${idx}" placeholder="è‡ªè¨‚å–®ä½" class="flex-1 p-2 border rounded text-sm hidden focus:ring-brand-gold focus:border-brand-gold">
                <button onclick="this.parentElement.remove()" class="text-red-500 font-bold px-2">&times;</button>
            `;
            container.appendChild(div);
        }

        function toggleCustomStat(idx) {
            const select = document.getElementById(`stat_type_${idx}`);
            const customInput = document.getElementById(`stat_cust_${idx}`);
            if (select.value === 'custom') {
                customInput.classList.remove('hidden');
            } else {
                customInput.classList.add('hidden');
            }
        }

        // --- Generation Logic ---
        function generateCopy() {
            let output = "";
            const getValue = (id) => document.getElementById(id)?.value || "";
            const getTeam = (key) => TEAMS[key];

            // Common helper for Next Game Block
            const getNextGameText = () => {
                const date = getValue('next_date');
                if(!date) return "";
                const mmdd = formatMMDD(date);
                const day = getDayChi(date);
                const time = getValue('next_time');
                const home = getValue('next_home');
                const away = getValue('next_away');
                const arena = TEAMS[home].arena;
                return `ğŸ“Œä¸‹å ´æ¯”è³½ï¼Œä¸€èµ·è¿é¢¨è€Œä¸Šã€‚\nâ–Œ ${mmdd}ï¼ˆ${day}ï¼‰ï½œ${time}ï½œ${TEAMS[away].full}ï¼ˆå®¢ï¼‰ vs. ${TEAMS[home].full}ï¼ˆä¸»ï¼‰ï½œ${arena}`;
            };
            
            const getNextGameTextShort = () => {
                const date = getValue('next_date');
                if(!date) return "";
                const monthDay = formatMonthDay(date); // DEC.03
                const time = getValue('next_time'); // 19:00
                const home = getValue('next_home');
                const away = getValue('next_away');
                const num = getValue('next_game_num');
                return `ğŸ“º NEXT GAME\n${monthDay}ï½œGame${num}ï½œ${time}ï½œ${TEAMS[away].full} ï¼ˆå®¢ï¼‰ vs. ${TEAMS[home].full} ï¼ˆä¸»ï¼‰`;
            }


            if (currentMode === 'game_preview') {
                const date = getValue('match_date');
                const time = getValue('match_time');
                const homeKey = getValue('home_team');
                const awayKey = getValue('away_team');
                const home = TEAMS[homeKey];
                const away = TEAMS[awayKey];
                
                const headerDate = `${toMathBoldSerif(formatMonthDay(date))}ï¼ˆ${toMathBoldSerif(getDayName(date))}ï¼‰`; 
                
                output = `#${toMathBoldSerif('GAMEDAY')}& #${toMathBoldSerif('ROSTER')}ï½œ ${headerDate}\n\n`;
                output += `ä¾‹è¡Œè³½ ${toMathBoldSerif('GAME')} ${getValue('game_num')} âœ¦ ${time} ${away.emoji}${awayKey} vs ${homeKey}${home.emoji}âœ¦\n\n`;
                output += `${getValue('highlight_text')}\n\nâ€”\n\n`;
                output += `ğŸ‘‰ğŸ»è³½äº‹åœ°é»ğŸ“${home.arena}\n${BROADCAST_INFO}\n`;
                output += `ğŸ‘‰ğŸ»YTè½‰æ’­é€£çµï½œ${getValue('yt_link')}\n\n`;
                output += `${COMMON_TAGS} #TPBLä¾‹è¡Œè³½ #moltentaiwan`;

            } else if (currentMode === 'weekday_preview') {
                const date = getValue('match_date');
                const home = TEAMS[getValue('home_team')];
                const away = TEAMS[getValue('away_team')];
                const dayName = getDayName(date); // WED
                const mmdd = formatMMDD(date); // 12.03
                const dayChi = getDayChi(date); // ä¸‰
                const title = getValue('promo_title');
                
                output = `ğŸ€ ${toMathBoldSerif(title)}\n\n`;
                output += `${getValue('promo_text')}\n\n-\n\n`;
                output += `ğŸ“Œ å°é€±æœ«å°±çœ‹ç±ƒçƒï¼š\n`;
                output += `â–Œ ${mmdd}ï¼ˆ${dayChi}ï¼‰ï½œ${getValue('match_time')}ï½œ${away.full}ï¼ˆå®¢ï¼‰ vs. ${home.full}ï¼ˆä¸»ï¼‰ï½œ${home.arena}\n\n-\n\n`;
                if(getValue('promo_link')) output += `${getValue('promo_link')}\n\n`;
                output += COMMON_TAGS;

            } else if (currentMode === 'final_score') {
                output = `ğŸ”™ ${toMathBoldSerif('GAME')} ${getValue('game_num')} FINALï½œ${getValue('match_title')}\n\n`;
                output += `${getValue('match_recap')}\n\n`;
                
                const date = getValue('next_date');
                if(date) {
                    const monthDay = formatMonthDay(date);
                    const home = TEAMS[getValue('next_home')];
                    const away = TEAMS[getValue('next_away')];
                    output += `ğŸ“ºNEXT GAME\n${monthDay}ï½œ${getValue('next_time')}ï½œ${away.full}ï¼ˆå®¢ï¼‰ vs. ${home.full}ï¼ˆä¸»ï¼‰`;
                }
                output += `\n\n${COMMON_TAGS} #TPBLä¾‹è¡Œè³½`;

            } else if (currentMode === 'game_highlight') {
                output = `${getValue('hl_title')}\n\n`;
                output += `ğŸ“º ç·¯ä¾†é«”è‚²å°ï½œåšæ–¯é‹å‹•äºŒå°ï½œTPBLå®˜æ–¹YOUTUBE\nğŸ‘‰ğŸ»YTè½‰æ’­é€£çµï½œ${getValue('yt_link')}\n\n`;
                output += `${COMMON_TAGS} #TPBLä¾‹è¡Œè³½`;

            } else if (currentMode === 'press_conf') {
                output = `ğŸ—£ï¸ ${toMathBoldSerif(getValue('pc_title'))}\n\n`;
                output += `ğŸ’¬ã€Œ${getValue('pc_quote')}ã€\n\n`;
                output += `${getValue('pc_content')}\n\n`;
                output += getNextGameText();
                output += `\n\n${COMMON_TAGS}`;

            } else if (currentMode === 'potg') {
                const home = TEAMS[getValue('potg_home')];
                const away = TEAMS[getValue('potg_away')];
                output = `â¤ï¸ ${toMathBoldSerif('NOTHING BUT HIM')}\n\n`;
                output += `${away.emoji} / ${home.emoji} #${toMathBoldSerif('å–®å ´æœ€ä½³çƒå“¡')}\n\n`;
                output += getNextGameTextShort();
                output += `\n\n-\n\n${getValue('promo_text')}\n\n${COMMON_TAGS} #TPBLä¾‹è¡Œè³½`;

            } else if (currentMode === 'weekly_schedule') {
                output = `â°ï½œ${toMathBoldSerif('WEEK')} ${toMathBoldSerif(getValue('week_num'))} ${toMathBoldSerif('SCHEDULE')} #æ¯é€±è³½ç¨‹\n\n`;
                output += `${getValue('week_intro')}\n\n-\n\nğŸ“Œ æœ¬é€±è³½äº‹é å‘Šï¼š\n`;
                
                const listContainer = document.getElementById('schedule_list_container');
                Array.from(listContainer.children).forEach(div => {
                    const inputs = div.querySelectorAll('input, select');
                    const d = inputs[0].value;
                    const t = inputs[1].value;
                    const a = TEAMS[inputs[2].value];
                    const h = TEAMS[inputs[3].value];
                    if(d) {
                         const mmdd = formatMMDD(d);
                         const day = getDayChi(d);
                         output += `â–Œ ${mmdd}ï¼ˆ${day}ï¼‰ï½œ${t}ï½œ${a.full}ï¼ˆå®¢ï¼‰ vs. ${h.full}ï¼ˆä¸»ï¼‰ï½œ${h.arena}\n`;
                    }
                });
                output += `\n${COMMON_TAGS}`;

            } else if (currentMode === 'weekly_standings') {
                output = `ğŸ“Šï½œ${toMathBoldSerif('WEEK')} ${getValue('week_num')} #çƒéšŠæˆ°ç¸¾æ’è¡Œ\n\n`;
                output += `${getValue('standings_content')}\n\n`;
                
                // New logic for schedule list in standings
                const listContainer = document.getElementById('standings_schedule_list_container');
                const hasChildren = listContainer && listContainer.children.length > 0;
                
                if (hasChildren) {
                    output += `ğŸ“Œ æœ¬é€±è³½äº‹é å‘Šï¼š\n`;
                    Array.from(listContainer.children).forEach(div => {
                        const inputs = div.querySelectorAll('input, select');
                        const d = inputs[0].value;
                        const t = inputs[1].value;
                        const a = TEAMS[inputs[2].value];
                        const h = TEAMS[inputs[3].value];
                        if(d) {
                             const mmdd = formatMMDD(d);
                             const day = getDayChi(d);
                             output += `â–Œ ${mmdd}ï¼ˆ${day}ï¼‰ï½œ${t}ï½œ${a.full}ï¼ˆå®¢ï¼‰ vs. ${h.full}ï¼ˆä¸»ï¼‰ï½œ${h.arena}\n`;
                        }
                    });
                     output += `\n${COMMON_TAGS}`;
                } else {
                    // Fallback if no games added (maybe season pause)
                    output += `\n${COMMON_TAGS}`;
                }

            } else if (currentMode === 'top5') {
                output = `ğŸ’£ï½œ${toMathBoldSerif('TOP')}ğŸ“ âœ¦ ${toMathBoldSerif('Week')} ${getValue('week_num')} ğŸ“¢\n\n`;
                output += `${getValue('top5_intro')}\n\n`;
                
                for (let i = 5; i >= 1; i--) {
                    const teamKey = document.getElementById(`top${i}_team`)?.value;
                    const num = document.getElementById(`top${i}_num`)?.value;
                    const name = document.getElementById(`top${i}_name`)?.value;
                    
                    if (name) { 
                        const team = TEAMS[teamKey];
                        const circledNum = ['â‘ ', 'â‘¡', 'â‘¢', 'â‘£', 'â‘¤'][i-1];
                        output += `${circledNum} ${team.emoji}${team.full} | #${num} ${name}\n`;
                    }
                }

                output += `\n${getValue('vote_link')}\n\n${COMMON_TAGS}`;

            } else if (currentMode === 'potw') {
                const team = TEAMS[getValue('player_team')];
                output = `ğŸ¥‡ ${toMathBoldSerif('PLAYER OF THE WEEK')} | #å–®é€±è¡¨ç¾æœ€ä½³çƒå“¡\n\n`;
                output += `ğŸ«¶ğŸ» ${toMathBoldSerif('NOTHING BUT')} ${team.emoji} ${getValue('player_name')}\n\n`;
                
                const statContainer = document.getElementById('stats_list_container');
                let statsArr = [];
                Array.from(statContainer.children).forEach(div => {
                    const val = div.querySelector('input[type="text"]').value;
                    const select = div.querySelector('select');
                    let unit = select.value;
                    
                    if (unit === 'custom') {
                        unit = div.querySelectorAll('input[type="text"]')[1].value;
                    }
                    
                    if (val) {
                        statsArr.push(`${val} ${unit}`);
                    }
                });
                
                output += `${toMathBoldSerif('STATS')} | ${statsArr.join(' / ')}\n\n`;
                output += `${getValue('player_desc')}\n\n-\n\n`;
                
                const date = getValue('next_date');
                if(date) {
                    const mmdd = formatMMDD(date);
                    const day = getDayChi(date);
                    const home = TEAMS[getValue('next_home')];
                    const away = TEAMS[getValue('next_away')];
                    const time = getValue('next_time');
                    const nameOnly = getValue('player_name').split(' ')[0] || "";
                    
                    output += `ğŸ“Œä¼‘æ¯ä¸€ä¸‹å›ä¾†çœ‹${nameOnly}ç™¼å¨ğŸ‘€\n`;
                    output += `â–Œ ${mmdd}ï¼ˆ${day}ï¼‰ï½œ${time}ï½œ${away.full}ï¼ˆå®¢ï¼‰ vs. ${home.full}ï¼ˆä¸»ï¼‰ï½œ${home.arena}`;
                }
                output += `\n\n${COMMON_TAGS}`;
            }

            document.getElementById('output-text').value = output;
        }

        // --- Utils ---
        function copyToClipboard() {
            const copyText = document.getElementById("output-text");
            copyText.select();
            document.execCommand("copy");
            
            const btn = document.getElementById("copy-text");
            const original = btn.innerText;
            btn.innerText = "å·²è¤‡è£½ï¼";
            setTimeout(() => btn.innerText = original, 2000);
        }

        // Initialize
        switchMode('game_preview');
    </script>
</body>
</html>
